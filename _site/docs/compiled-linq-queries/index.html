<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/images/favicon.ico">
	<link rel="stylesheet" href="/css/bootstrap.min.css">
	<link rel="stylesheet" href="/stylesheets/pygment_trac.css">
	<link rel="stylesheet" href="/stylesheets/stylesheet.css">
	

    <title>Compiled Linq Queries - OrigoDB</title>


    <!-- Custom styles for this template -->
    <link href="starter-template.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
  
  <a href="https://github.com/devrexlabs"><img style="position: absolute; top: 40px; right: 0; border: 0;" src="https://camo.githubusercontent.com/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"></a>

    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>

                  <a class="brand" href="/" style="float: left; font-size: small">
                    <img style="margin-top: 12px; margin-left:16px; height: 26px; width: 26px" src="/images/origodb.png" /></a>

        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
		<li><a class="brand" href="/">Start</a></li>
		  <li><a href="/intro">Intro</a></li>
			<li><a href="/examples">Examples</a></li>
			<li><a href="/repos">Repositories</a></li>
			<li><a href="/docs">Documentation</a></li>
			<!-- <li><a href="/blog">Blog</a></li> -->
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

    <div class="container">

      <div class="starter-template">
		<h2 id="compiled-linq-queries">Compiled Linq Queries</h2>
<p><em>Note! This is an experimental feature and subject to change!</em></p>

<p>An OrigoDb engine can compile and cache parameterized linq queries passed as a strings. </p>

<p>The following extension methods are defined in the namespace <code>OrigoDB.Core.Linq</code>:</p>

<div class="highlight"><pre><code class="csharp"><span class="k">public</span> <span class="kt">object</span> <span class="n">Engine</span><span class="p">.</span><span class="n">Execute</span><span class="p">(</span><span class="kt">string</span> <span class="n">linqQuery</span><span class="p">,</span> <span class="n">param</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">args</span><span class="p">);</span>
    <span class="k">public</span> <span class="n">TResult</span> <span class="n">Engine</span><span class="p">.</span><span class="n">Execute</span><span class="p">&lt;</span><span class="n">TModel</span><span class="p">,</span> <span class="n">TResult</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">linqQuery</span><span class="p">,</span> <span class="n">param</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">args</span><span class="p">);</span></code></pre></div>

<p>The linqQuery must be a valid c# expression. The expression is evaluated with the provided arguments and the result is returned to the caller.</p>

<h2 id="parameters">Parameters</h2>
<p>Use <code>db</code> within the query to reference the model during execution. <br />
Access the arguments in the <code>args</code> param array using <code>@arg0</code>, <code>@arg1</code>, <code>@arg2</code> etc<br />
The type of each parameter is derived from the actual argument passed. Example:</p>

<div class="highlight"><pre><code class="csharp"><span class="k">class</span> <span class="nc">Customer</span><span class="p">{</span> <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span><span class="p">;}</span>
    <span class="n">engine</span><span class="p">.</span><span class="n">Execute</span><span class="p">(</span><span class="s">&quot;@arg0.Name&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Customer</span><span class="p">{</span><span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Homer&quot;</span><span class="p">});</span></code></pre></div>

<p>Note how the <code>Customer.Name</code> property is used within the query.</p>

<h2 id="example">Example</h2>

<div class="highlight"><pre><code class="csharp"><span class="c1">//import extension methods</span>
    <span class="k">using</span> <span class="nn">OrigoDb.Core.Linq</span><span class="p">;</span>

    <span class="kt">var</span> <span class="n">query</span> <span class="p">=</span> <span class="s">&quot;(from Customer c in db.Customers where c.Name.StartsWith(@arg0)).First()&quot;</span>
  
    <span class="c1">//call untyped</span>
    <span class="kt">object</span> <span class="n">untypedResult</span> <span class="p">=</span> <span class="n">engine</span><span class="p">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="s">&quot;R&quot;</span><span class="p">);</span> <span class="c1">// &quot;R&quot; is params object[]</span>

    <span class="c1">//call typed</span>
    <span class="kt">string</span> <span class="n">customerName</span> <span class="p">=</span> <span class="n">engine</span><span class="p">.</span><span class="n">Execute</span><span class="p">&lt;</span><span class="n">MyModel</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;(</span><span class="n">query</span><span class="p">,</span> <span class="s">&quot;H&quot;</span><span class="p">);</span></code></pre></div>

<h2 id="compilation">Compilation</h2>
<p>The query is compiled the first time it is evaluated. The compilation depends on the number and types of arguments passed. Subsequent calls with the same linqQuery must pass the same number and types of arguments.</p>

<h2 id="security-warning">Security Warning!</h2>
<p>Beware of the risk of arbitrary code injection. There is a test case in the source with an example exploit.</p>

		
      </div>
		<div class="well well-sm">
		&copy; Devrex Labs | OrigoDB - In-memory database toolkit for NET/Mono | Build faster systems, faster 
		</div>

    </div><!-- /.container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
  </body>
</html>
	